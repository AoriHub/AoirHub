<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤ | ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</title>
    <style>
        body { font-family: Arial, sans-serif; background: #222; color: white; margin: 0; padding: 20px; }
        .header { text-align: right; padding: 10px; background: #333; }
        .container { max-width: 600px; margin: auto; }
        .product { background: #333; padding: 10px; margin: 10px 0; border-radius: 10px; }
        .product img { width: 100%; border-radius: 10px; }
        .product button { background: green; color: white; padding: 10px; width: 100%; border: none; cursor: pointer; }
        .history { background: #444; padding: 10px; border-radius: 10px; margin-top: 20px; }
        .stock { color: yellow; }
    </style>
</head>
<body>

    <div class="header">
        üë§ <span id="username">Guest</span> | üí∞ <span id="userBalance">0</span> ‡∏ö‡∏≤‡∏ó
    </div>

    <div class="container">
        <h2>‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
        <button onclick="addMoney(50)">‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô 50 ‡∏ö‡∏≤‡∏ó</button>

        <div id="productList"></div>

        <div class="history">
            <h3>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠</h3>
            <div id="purchaseHistory"></div>
        </div>

        <div class="history">
            <h3>üì¢ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</h3>
            <p id="adminMessageDisplay">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</p>
        </div>
    </div>

    <script>
        let username = localStorage.getItem("username") || "Guest";
        let userBalance = localStorage.getItem("userBalance") || 100;
        document.getElementById("username").innerText = username;
        document.getElementById("userBalance").innerText = userBalance;

        let products = JSON.parse(localStorage.getItem("adminProducts")) || [
            { id: 1, name: "‡∏ú‡∏• Mammoth", price: 50, stock: 5, img: "https://via.placeholder.com/300" }
        ];

        function loadProducts() {
            let productList = document.getElementById("productList");
            productList.innerHTML = "";
            products.forEach(product => {
                productList.innerHTML += `
                    <div class="product">
                        <img src="${product.img}" alt="${product.name}">
                        <h3>${product.name}</h3>
                        <p>‡∏£‡∏≤‡∏Ñ‡∏≤: ${product.price} ‡∏ö‡∏≤‡∏ó</p>
                        <p class="stock">‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: <span id="stock-${product.id}">${product.stock}</span> ‡∏ä‡∏¥‡πâ‡∏ô</p>
                        <button id="buy-${product.id}" onclick="buyProduct(${product.id})" ${product.stock <= 0 ? "disabled" : ""}>${product.stock > 0 ? "‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏¢" : "‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏°‡∏î"}</button>
                    </div>
                `;
            });
        }

        function buyProduct(productId) {
            let product = products.find(p => p.id === productId);
            if (userBalance >= product.price && product.stock > 0) {
                userBalance -= product.price;
                product.stock -= 1;
                localStorage.setItem("userBalance", userBalance);
                document.getElementById("userBalance").innerText = userBalance;

                let orders = JSON.parse(localStorage.getItem("orders")) || [];
                let date = new Date().toLocaleString();
                orders.push({ ...product, date });
                localStorage.setItem("orders", JSON.stringify(orders));

                updatePurchaseHistory();
                alert("‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");

                localStorage.setItem("adminProducts", JSON.stringify(products));
                document.getElementById(`stock-${product.id}`).innerText = product.stock;
                if (product.stock <= 0) {
                    document.getElementById(`buy-${product.id}`).innerText = "‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏°‡∏î";
                    document.getElementById(`buy-${product.id}`).disabled = true;
                }

                let adminNotifications = JSON.parse(localStorage.getItem("adminNotifications")) || [];
                adminNotifications.push(`${username} ‡∏ã‡∏∑‡πâ‡∏≠ ${product.name} ‡πÄ‡∏°‡∏∑‡πà‡∏≠ ${date} (‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ${product.stock} ‡∏ä‡∏¥‡πâ‡∏ô)`);
                localStorage.setItem("adminNotifications", JSON.stringify(adminNotifications));
            } else {
                alert("‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏°‡∏î!");
            }
        }

        function updatePurchaseHistory() {
            let historyDiv = document.getElementById("purchaseHistory");
            let orders = JSON.parse(localStorage.getItem("orders")) || [];
            historyDiv.innerHTML = orders.map(order => `<p>üõí ${order.name} - ${order.date}</p>`).join("");
        }

        function addMoney(amount) {
            userBalance = parseInt(userBalance) + amount;
            localStorage.setItem("userBalance", userBalance);
            document.getElementById("userBalance").innerText = userBalance;
        }

        function loadAdminMessage() {
            let message = localStorage.getItem("adminMessage") || "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°";
            document.getElementById("adminMessageDisplay").innerText = message;
        }

        loadProducts();
        updatePurchaseHistory();
        loadAdminMessage();
    </script>
</body>
</html>